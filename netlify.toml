[build]
  # 發布目錄（Web App 文件）
  publish = "frontend/web"
  
  # 構建命令：將數據庫文件複製到函數目錄，確保函數可以訪問
  command = "bash netlify-build.sh"

# Netlify Functions 配置
[functions]
  # Functions 目錄
  directory = "netlify/functions"

# 重定向規則（將 API 請求重定向到 Functions）
# 將所有 /api/restaurants/* 請求重定向到 Netlify Function
[[redirects]]
  from = "/api/restaurants/*"
  to = "/.netlify/functions/restaurants"
  status = 200
  force = true

# SPA 路由支持（所有非 API 和非靜態資源請求都返回 index.html）
# 注意：Netlify 會按照順序匹配規則，所以靜態資源會自動被正確處理
# 只有不匹配其他規則的路徑才會被重定向到 index.html
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
